## 보안의 개념과 정의
- 정보 보안의 정의
    - 필수요소 
        - 기밀성(Confidentiality) : 공개 범위 제한
        - 무결성(Integrity) : 완전한 정보 유지 
        - 가용성(Availability) : 접근 관리
    
    - 네트워크 정보 보안
        - 자료유출, 서비스 방해를 막는 것이 목표

- 네트워크 보안의 주요개념
    - Trust 네트워크 : 보호받아 할 네트워크
    - Untrust 네트워크 : 신뢰할 수 없는 외부 네트워크
    - DMZ(DeMilitarized Zone) 네트워크 : 신뢰할 수 없는 외부 사용자에게 개방해야 하는 서비스 네트워크

    - 네트워크 보안 분야
        - Internet Secure Gateweay
            - Trust, DMZ 에서 Untrust로의 통신을 통제
            - 패킷을 적절히 인식하고 필터링하는 기능 필요(SWG, 웹 필터, 애플리케이션 컨트롤, 샌드박스)
        
        - Data Center Secure Gateway
            - Untrust에서 Trust, DMZ로의 통신을 통제
            - 외부의 공격을 막기위한 공격관련 정보 필요(방화벽, IPS, DCSG, WAF, Anti-DDoS)

- 네트워크 보안 정책 수립에 따른 분류
    - 화이트리스트 : 신뢰할 수 있는 통신만 허용하는 방식

    - 블랙리스트 : 문제가 있었던 IP, 패킷 리스트를 기반으로 데이터베이스를 만들어서 방어하는 방식(공격 패턴)


- 정탐, 오탐, 미탐(탐지 에러 타입)
    - 오탐 : 정상 패킷을 공격으로 탐지하고 드롭
    - 미탐 : 공격 패킷을 정상으로 탐지하고 허용
    - 정탐 : 패킷을 올바르게 탐지하고 드롭/허용


## 보안 솔루션의 종류
- DDoS 방어 장비
    - DoS는 일반적으로 공격 출발지에서 직접 공격한다
        - 탐지가 쉽고 IP주소 기반으로 방어가능
        - 다수의 봇을 이용한 분산공격 DDoS가 등장
    
    - DDoS 방어 장비는 볼류메트릭 공격을 방어하기 위해 네트워크 내부와 외부의 경계에 위치한다
        - 볼류메트릭(Volumetric) 공격 : 회선 사용량, 트래픽을 과도하게 발생시켜 사용을 방해하는 공격

- 방화벽
    - 4계층에서 동작하는 패킷 필터링 장비 
        - 3/4계층 정보를 기반으로 정책을 세워 패킷을 허용/거부 한다
    
- IDS(Instrusion Detectino System), IPS(Intrusion Prevention System)
    - 방화벽에서 방어할 수 없는 다양한 어플리케이션 공격을 방어하는 장비
    - 제조사나 서비스 업체로부터 공격 데이터베이스를 제공받아서 패킷을 검사한다

- WAF(Web Application Firewall)
    - HTTP, HTTPS처럼 웹 서버에서 동작하는 웹 프로토콜의 공격을 방어하는 장비
        - IPS에서 방어할 수 없는 IPS회피 공격을 방어할 수 있다
    
    - 프록시 서버처럼 패킷을 데이터 형태로 조합해 처리한다
        - 데이터를 추가/수정할 수 있다

- 샌드박스
    - APT(Advanced Persistent Threat), ATA(Advanced Target Attack)
        - 악성코드를 다운받도록 속여서 PC를 감염시키는 방법
        - C&C(Command&Control) 서버 : 악성코드로 감염된 PC와 연결된 서버
            - 방화벽에서는 정상적인 통신으로 보여서 방어하기 어렵다
        
    - 샌드박스는 APT의 공격을 방어하는 대표적인 장비이다
        - 가상 운영체제 안에서 파일을 직접 실행시켜서 모니터링하고 악성코드 여부를 판별한다
    
- NAC(Network Access Control)
    - 네트워크에 접속하는 장치들을 제어하는 장비
    - 인가된 사용자만 내부망에 접속할 수 있다

- IP제어
    - IP를 할당하고 인증된 IP가 아니면 네트워크 접속을 막는 기능
        - NAC와 공통적인 기술이지만 다른 목적으로 개발되었다
    
- 접근 통제
    - 서버, 데이터베이스에 대한 직접적인 접근을 막고 작업 추적 및 검사를 하는 접근 통제 솔루션
    - 배스천 호스트기반으로 가장 많이 구현된다
        - 서버에서 배스천 호스트를 통해서온 통신만 허용한다
    
- VPN
    - IPSEC, SSL이 가장 많이 쓰인다

    
## 방화벽
- 방화벽의 정의
    - 네트워크 3,4계층에서 동작
    - 세션을 인지하는 상태기반엔진(Stateful Packet Inspection, SPI)로 동작한다

- 초기 방화벽
    - 패킷 필터(Packet Filter), 스테이트리스(Stateless)
        - SPI엔진이 없어서 패킷의 인과 관계(세션)을 인지하지 못해서 정책(5-튜플)만으로 단순히 패킷을 필터링했다
            - 핸드셰이크의 요청과 응답과정에서 응답 패킷에 대한 정책이 없어서 모든 패킷을 허용해야 통신할 수 있었다
        - 5-tuple : source IP, Dest IP, Protocol No, Source Port, Dest Port
    
    - 문제점 
        - 불특정 다수 기반의 정책을 정의할 때 보안이 약화되는 문제가 있다
        - 5-튜플 외에 3,4계층 헤더를 변조해 공격하면 방어가 불가능하다
    
- 현대적 방화벽(SPI)
    - 상태 기반 방화벽(Stateful Inspection Firewall) : 세션 기반으로 동작하는 SPI엔진으로 동작한다
        - 패킷의 양방향 통신을 이해해서 요청에 응답하는 통신을 허용할 수 있다
    
- 방화벽 동작 방식
    - 방화벽 제조사별로 동작방식이 다양해서 제조사가 제공하는 Packet Processing Flow 문서를 확인해야 한다
    - *패킷 처리 순서*
        - 세션 상태 테이블 확인
            - 없으면 방화벽 정책 확인
                - 없으면 암시적 거부(Implicit Denial)규칙을 참고해 차단된다
                - 허용 규칙이 있으면 세션테이블에 저장한다
            
        - 세션 정보를 찾으면 포워딩 테이블을 확인한다(라우팅, ARP포함)
            - 있으면 적절한 인터페이스로 패킷을 포워딩
            - 없으면 패킷 폐기
        
    
    - OSI 3,4 계층의 세부적 필드도 같이 확인한다
        - TCP컨트롤 플래그로 동작 방식이 변하거나 시퀀스와 ACK 번호가 갑자기 변경되는 것을 인지해 세션 탈취 공격을 일부 방어할 수 있다
        - 세션을 로깅하기 쉽다
    
- ALG(Application Layer Gateway)
    - FTP같은 오래된 프로토콜은 방화벽과 호환되지 않는다
        - FTP 액티브 모드는 데이터 프로토콜과 컨트롤 프로토콜이 반대로 세션을 맺어서 방화벽이 이해하지 못한다
    
    - ALG : 애플리케이션 프로토콜을 확인하고 필요에 따라 세션을 인지해서 포트를 자동으로 열어준다  
        - PAT기능이 동작하는 방화벽에서 PAT를 정상적으로 통과하지 못하는 프로토콜을 인지해 세션 테이블을 만들어준다
    
- 방화벽의 한계
    - 상태 기반 방화벽으로 인해 새로운 공격 방식이 생겨났다
        - 공격 목표가 시스템이나 계정탈취에서 서비스 중단 쪽으로 바뀌고 DDoS공격이 새로운 트렌드가 되었다
    
    - 방화벽은 3,4계층의 정보만 인지하는 한계가 있다
        - 백도어나 인터넷 웜, 취약점 공격등을 방어할 수는 없다
            - 웜 공격을 막기위해 IPS가 등장했다
        
- *현대 방화벽 NGFW, UTM*
    - 상태 기반 방화벽은 레거시 방화벽이라고 한다
    - Next Generation Firewall, Unified Threat Management Firewall
        - 방화벽을 애플리케이션 영역까지 확장한 보안 장비이다

- *NFV(Network Function Virtualization)*
    - 네트워크 컴포넌트를 가상화해 범용 하드웨어에 적용하는 기술
        - 성능에 한계가 있지만 새로운 서비스를 추가, 삭제, 적용할 수 있다
    
    
    

