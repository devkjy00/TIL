# 자바에서의 입출력
- I/O란 input, output의 약자로 입력과 출력이다, 외부의 장치와 프로그램간의 데이터를 주고받는 것을 말한다

- ***스트림***
	- 스트림이란 데이터를 운반하는데 사용되는 연결통로이다
	- 단방향 통신만 가능하기 떄문에 입력과 출력을 동시에 처리할 수 없다
	- 스트림은 큐처럼 먼저 보낸 데이터를 먼저 받게 되어있다
	- java.io
		- https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/package-summary.html
		- 입출력관련 클래스들을 표준화해서 제공한다

- ***InputStream, OutputStream  바이트기반 스트림***
	- byte기반으로 입출력 단위가 1byte이다
	
	- 종류
		- {File, ByteArray, Piped, Audio} InputStream, OutputStream
		- 모두 InputStream, OutputSteam의 자손들이다
	
	- read, write 추상메서드
		- 입출력 각각 read, write메서드만 구현하면 된다
		- read, write를 구현하지 않으면 클래스내에 다른 메서드는 아무런 의미가 없다
			- 다른 메서드들도 내부적으로 read, write를 호출한다

- ***Reader, Writer 문자기반 스트림***
	- char기반으로 입출력 단위가 2byte이다
		- 자바에서는 한문자를 의미하는 char형이 1byte가 아니라 2byte이다 
		- 그래서 바이트기반 스트림으로 문자를 처리하는데 어려움이 있다
		- 이러한 문제점을 보완 하기 위해서 문자기반 스트림을 사용하는게 좋다
	
	- 종류
		- {File, CharArray, Piped, String} Reader, Writer
		- 문자 기반이기 때문에 ByteArray에서 CharArray로 바뀌었다
	
	- read, write 추상메서드
		- 구현해야 하는 추상메서드의 매개변수가 바뀌었다
			- int read() -> int read(char[] cbuf, int off, int len)
			- void write() -> void write(char[] cbuf, int off, int len)

- ***보조 스트림***
	- 스트림의 기능을 보완하기 위해 제공되는 스트림이다
		- 생성된 기반스트림의 인스턴스를 이용해서 보조스트림을 생성한다
		- 거의 모든 보조스트림은 FilterInputStream의 자손들이고 FilterInputStream은 InputStream의 자손이다
		- 문자기반 보조스트림도 Reader, Writer라는 이름으로 동일하다
	
	- 바이트 기반 보조스트림
		- Filter{IS,OS}	: 필터를 이용한 입출력 처리
		- Buffered{IS,OS} : 버퍼를 이용한 입출력 성능향상
		- Data{IS,OS} : 기본형 단위로 데이터를 처리
		- Object{IS,OS} : 데이터를 객체단위로 읽고 쓰는데 사용, 주로 파일을 이요하고 객체 직렬화와 관련이 있다
		- SequenceInputStream{IS} : 스트림을 하나로 연결
		- PrintStream{OS} : 버퍼를이용해서 추가적인 print관련 기능제공
		- PushbackInputStream{IS} : 버퍼를 이용해서 읽어 온 데이터를 다시 되돌리는 기능

	- 문자 기반 보조스트림
		- Buffered, Filter, Print, PushBack {Reader, Writer}
		- LineNumderReader : 데이터의 라인 번호를 카운트한다
			
	- ***스트림을 닫을 때 기반스트림이 아닌 보조스트림에서 close를 호출해야 한다***
		- 닫기 전에 값이 null 인지 체크해야한다, null일 때 close를 호출하면 NullPointerException이 발생한다
		- close는 IOException을 발생시킬 수 있기 때문에 예외처리를 해야 한다
		- try-with-resources문을 이용하면 간결하게 표현할 수 있다

	
# 바이트기반 스트림
- inputStream 메서드
	- available		: 읽어 올 수 있는 데이터의 크기를 반환
	- close			: 스트림을 닫아서 자원을 반환한다
	- skip			: 스트림에서 주어진 길이 만큼 건너뛴다
	- mark			: 현재 위치를 표시 한다
	- reset			: 스트림의 위치를 마지막 mark가 호출됬던 위치로 되돌린다
	- markSupported	: mark, reset을 지원하는지 알려준다
	- read			: 1 byte를 읽어온다(0~255), 데이터가 없으면 -1을 반환한다
		- byte배열을 매개변수로 주면 배열에 저장한다, 몇개의 배열의 지정된 인덱스 부터 저장하도록 지정할 수 있다
	
- OutputStream 메서드
	- close 		: 입력소스를 닫아서 자원을 반환한다
	- flush			: 스트림의 버퍼에 있는 모든 내용을 출력소스에 쓴다
		- 버퍼가 있는 스트림의 경우에만 의미가 있다
	- write			: 주어진 값을 출력소스에 쓴다
		- byte배열을 지정해서 저장된 모든 내용을 출력소스에 쓸수 있다
		- 배열의 저장된 내용중 지정된 인덱스부터 몇개의 인덱스를 쓸지 지정할 수 있다
	
- 프로그램이 종료될 때 JVM이 스트림을 자동적으로 닫아 주기는 하지만 반드시 close를 호출해서 닫아 주어야 한다
	- 메모리를 사용하는 ByteArrayInputStream와 표준 입출력 스트림인 System.in, System.out은 닫아 주지 않아도 된다

- ***ByteArrayInputStream, ByteArrayOutputStream***
	- 메모리, 즉 바이트 배열에 데이터를 입출력하는데 사용되는 스트림이다
		- 주로 입출력하기 전에 임시로 바이트배열에 담아서 변환 등에 작업을 하는데 사용한다
	```java
	byte[] src = {~~~};
	ByteArrayInputStream input = new ByteArrayInputStream(src);
	ByteArrayOutputStream output = new ByteArrayOutputStream();

	int data = 0;
	while((data = input.read()) != -1) {
		output.write(data);
		}
	System.out.println("src :" + Arrays.toString(output.toByteArray()));
	```
		- 바이트 배열은 사용하는 자원이 메모리 밖에 없으므로 가비지컬렉터에 의해 자동적으로 자원을 반환하기 때문에 스트림을 닫지 않아도 된다
		- read()만 사용하면 한번에 1byte만 읽어오기 때문에 작업 효율이 떨어진다, 배열을 사용해서 효율적으로 만들어야 한다
			- 매개변수를 통해서 데이터를 배열에 저장하고 배열의 데이터를 출력한다
			- 데이터를 읽어서 배열에 저장할 때마다 배열에 데이터를 덮어쓴다, 만약 더 짧은 데이터를 덮어쓰면 이전에 데이터가 남아있기 때문에 길이를 매개변수로 지정해서 읽어온 만큼만 출력하도록 할 수 있다
		
		- read, write는 IOException을 발생시킬 수 있기 때문에 예외처리를 해줘야 한다


- ***FileInputStream, FileOutputStream***
	- 파일 입출력을 하기 위한 스트림이다

	- InputStream 생성자
		- 지정된 파일이름을 가진 실제 파일의 스트림을 생성한다
		- File인스턴스나 파일디스크립터로 생성할 수 있다

	- OutputStream 생성자	
		- 지정된 파일 이름과 두번째 인자로 덮어쓸지 이어쓸지 지정할 수 있다
		- File인스턴스나 파일디스크입터로 생성할 수 있다
	
	- 텍스트 파일을 다루는 경우 문자기반 스트림인 FileReader/FileWriter를 사용하는 것이 더 좋다

# 바이트기반의 보조 스트림
- ***FilterInputStream, FilterOutputStream***
	- 모든 보조 스트림의 조상이다, 생성자의 매개변수로 기반스트림을 필요로한다
	- 단순히 기반스트림의 메서드를 그대로 호출한다
	- InputStream은 생성자가 protected이기 때문에 상속을 통해서 구현해야 한다

- ***BufferedInputStream, BufferedOutputStream***
	- 입출력의 효율을 높이기 위해 버퍼를 사용하는 보조스트림이다
		- 1byte씩 입출력 하는 것 보다 버퍼를 이용해서 한번에 여러 바이트를 입출ㄹ겨하는 것이 빠르기 때문에 대부분의 입출력에 사용된다
	
	- Input생성자,메서드
		- 기반스트림으로 생성되고 버퍼의 크기를 지정할 수 있다
		- 버퍼크기는 한번에 가져올 수 있는 데이터의 크기로 지정하면 좋다
		- read		: 데이터를 읽으면 자신의 내부 버퍼에 저장한다
	
	- Output생성자, 메서드	
		- 기반스트림으로 생성, 버퍼크기 지정
		- flush 	: 모든내용을 출력, 버퍼를 비운다
		- close		: flush호출, 모든 자원을 반환한다
			- 버퍼를 비운후에 참조변수에 null을 저장함으로써 자원들이 반환되게 한다
		- write		: 출력이 버퍼에 저장되고 버퍼가 가득차면 그때 버퍼의 모든내용을 출력소스에 출력한다
			- 가득 찼을 때만 출력 하기 때문에 마지막부분이 출력되지 않을 수 있다
			- flush, close를 호출해서 마지막에 버퍼의 내용을 출력하도록 해야한다
	
- ***DataInputStream, DataOutPutStream***
	- 8가지 기본자료형의 단위로 읽고 쓸수 있게 해준다
		- 각 기본자료형을 16진수로 표현하여 저장한다
		- 각 자료형의 크기가 다르기 때문에 출력한 데이터를 다시 읽어 올때는 출력했을 때의 순서를 염두에 두어야 한다
	- 각각 DataInput, DataOutput 인터페이스를 구현했다

	- Input생성자, 메서드
		- 기반스트림으로 생성
		- read{Boolean, Byte, Char, Short, Int, Long, Float, Double, UnsignedByte, UnsignedShore}	
			- 각 타입에 맞게 값을 읽어온다, 없으면 EOFExecption발생
		
		- readFully			: 지정된 배열의 크기만큼, 지정된 위치에서 지정한 길이만큼 데이터를 읽는다, EOFException, IOExecption 
		- readUTF			: UTF형식으로 쓰여진 문자를 읽는다, EOFException
		- skipBytes			: n만틈건너 뛴다
	
	- Output생성자, 메서드
		- 기반스트림으로 생성
		- write{Boolean, Byte, Char, Chars, Short, Int, Long, Folat, Double}
		- writeUTF			: UTF형식으로 출력
		- writeChars		: 주어진 문자열을 출력한다
		- size				: 쓰여진 byte의 수를 알려준다
	
	- 출력한 값들은 이진데이터로 저장된다, ByteArrayOutputStream을사용하면 이진데이터를 확인할 수 있다
		- byte단위의 데이터 변환 및 조작이 가능하다

	- 주의할 점
		- boolean true를 저장할 경우 모든 bit가 1인 1byte가 저장된다
		- 그 값은 부호없는 정수(0~255)로 255이고 부호있는 정수(-128~127)는 -1이 된다
		- byte가 부호있는 정수이기 떄문에 -1로 인식하게 되고 이 값을 0~255사이의 값으로 변환하려면 256을 더해 주어야 한다
		


- ***SequenceInputStream***
	- 여러 개의 입력스트림을 연속적으로 연결해서 하나의 스트림으로부터 데이터를 읽는 것과 같이 처리할 수 있도록 도와준다
		- inputStream을 바로 상속 받아서 구현됬다
		- 큰파일을 여러개의 작은 파일로 나누었다가 하나의 파일로 합치는 것과 같은 작업을 수행할 때 사용하면 좋다

	- 생성자
		- Enumeration에 저장된 순서대로 입력스트림을 하나의 스트림으로 연결한다
			```java
			Vector files = new Vector();
			files.add(new FileInputStream("file1"));
			files.add(new FileInputStream("file2"));
			sequenceInputStream in = new SequenceInputStream(files.elements());
			// Vector에 스트림을 저장해서 Enumeration의 elements로 매개변수를 지정한다
			```
		- 두개의입력스트림을 매개변수로 받아서 연결 한다


- ***PrintStream***
	- 데이터를 기반스트림에 다양한 형태로 출력할 수 있는 print, println, printf와 같은 메서드를 오버로딩하여 제공한다
	- 문자를 출력하는 것이기 때무넹 문자기반 스트림의 역할을 수행한다
		- 향상된 PrintWriter가 추가되었지만 둘다 같이 사용된다
	
	- 생성자
		- 기반스트림으로 생성, autoFlush값을 true로 하면 println메서드가 호출되거나 개행문자가 출력될 때 자동으로 flush된다

	- 메서드
		- checkError		: 스트림을 flush하고 에러가 발생했는지 알려준다
		- setError			: 오류가 발생했음을 알린다
		- print, println, printf
			- 예외를 내부에서 처리하도록 정의했는데, 이유는 미우 자주 사용되기 때문이다
			- IOException이 발생하면 checkError을 통해서 인지 할 수있다
			
	- Fomatter클래스
		- printf의 형식화에 사용된다
		- %d(10진수), %o(8), %x(16), %c(char), %s(String), %5d(5자리), %-5d(왼쪽정렬), %05d(빈자리0)
		- %e(지수), %f(float)
		- 날짜와 시간 출력
			```java
			Date d = new Date();
			System.out.printf("오늘은 %tY년 %tM월 %tD일 입니다\n", d,d,d);
			System.out.printf("지금은 %1$tH시 %1$tM분 %1$tS분 입니다\n", d);
			// 1$는 매개변수의 위치를 지정한다
			```


