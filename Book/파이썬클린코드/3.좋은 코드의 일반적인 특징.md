좋은 소프트웨어는 좋은 디자인으로부터 나온다
코드가 디자인이고, 디자인이 곧 고드이다

### 계약에 의한 디자인(Design by Contract - DbC)
컴포넌트는 기능을 숨겨서 캡슐화하고 고객에게 애플리케이션 프로그래밍 인터페이스(API)를 노출해야 한다

- 계약
    - API를 디자인 할 때 예상되는 입력,출력 및 부작용을 문서화 해야한다, 계약의 개념
    - 사전조건과 사후조건을 명시하고 불변식과 부작용을 기술한다
    - 계약을 어겼을 경우 명시적으로 예외를 발생시켜야 한다
        - 문제를 정확하게 특정하기 위해서 사용자 예외를 만드는 것이 가장 좋다

    - 오류를 쉽게 찾을 수 있고 책임의 한계를 명확히할 수 있다
        - 격리된 상태로 유지해서 사전조건,사후조건에 대한 검사 그리고 핵심 기능 구현을 구분하는 것이 좋다 

    - 사전조건 : 제공된 데이터의 유효성을 검사, 데이터베이스, 파일, 이전의 메서드 검사등
        - mypy 같은 정적 분석 도구도 효과적이지만 충분하지 않다
        - 유효성 검사를 어디서 할지를 정해야한다
            - 함수를 호출하지 전(관용적 접근법): 어떤 값이라도 수용한다
            - 함수가 자체적으로(까다로운 접근법): 안전하고 견고한 방법
            - 중복을 피해서 작성해야 한다

    - 사후조건 : 함수 반환 값의 유효성 검사
        - 특정 속성이 보존되도록 보장해야한다

    - 불변식 : docstring에 함수의 연산을 문서화
    - 부작용 : docstring에 코드의 부작용을 언급하기도 한다

    - 올바른 데이터 타입만 검사하기 보다는 특정 예외처리를 하는 것이 바람직하다

### 방어적(defensive) 프로그래밍
코드의 모든 부분을 유효하지 않은 것으로부터 스스로 보호 할 수 있게 하는 것으로 여러측면을 고려한 기술

- 에러 핸들링
    - 데이터 입력 확인 시 자주 사용하고 에러에 대해서 실행할지 중단할지를 결정하는 것이 목적
    - 에러 처리 방법
        - 값 대체
            - 결과 값을 안전한 다른 값으로 대체, 신중하게 선택해야 한다
            - 견고성과 정확성간의 트레이드 오프이다
            - 기본 값으로 대체하는 것이 안전하지만 실패하는 것이 옳을 때 도 있다
                - 오류가 있는 데이터를 유사한 값으로 대체하는 것은 위험, 오류를 숨길 수 있다
        
        - 에러 로깅

        - 예외 처리
            - 호출자에게 실패했음을 알리는 것
            - 예외 처리로 로직처리나 흐름제어를 하면 복잡해진다, 실질적 문제에만 사용
            - 캡슐화를 약화 시키기 때문에 주의, 너무 많은 예외는 여러개의 작은 것으로 나누는 것이 좋을 수 있다
            - ***올바른 수준의 추상화 단계에서 예외 처리***
                - 예외는 한가지 일을 하는 함수의 한 부분이어야 한다
                - 예외가 속한 상황의 바로 뒤에 처리해야한다
            - ***Traceback 노출 금지***
                - 특정 예외에는 trace정보, 메시지 및 수집 가능한 정보를 로그로 남기는 것이 중요하다
                - 보안을 위한 고려사항으로 사용자에게 보여서는 안된다, 중요 정보나 지적 재산의 유출이 발생할 위험
                - 예외가 발생했을때 일반적인 메시지를 사용해야 한다, "인터넷 연결 오류"
            - ***비어있는 except블록 지양***
                - 에러는 무조건 명시적으로 전달해야 한다
            - ***원본 예외 포함***
                - 오류 처리 과정에서 다른 오류를 발생시킬때 원래 예외를 포함하는 것이 좋다
                - raise e from 원래 예외
                    - 예외의 타입을 변경한다
                    - 원본 예외는 ```__cause__```속성으로 설정된다

            - ***assert 사용***
                - 불가능한 조건을 의미하는 것으로 잘못된 시나리오에 도달할 경우 프로그램을 중단 시키는 것
                - 흐름 제어에 사용하면 안된다
                - AssertionError를 처리하면 안되고(프로그램 중단이 목적) 함수로 값을 반환하는 것은 좋지 않다
            

