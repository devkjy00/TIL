#### 위험과 전략
- 악의적인 입력 
	- 필터 API를 사용해서 부적절한 프롬프트를 방지
	- 업로드된 사용자 이미지에 NSFW필터를 사용
		- NSFW(Not Safe For Work)

- 환각 
- 편향 : 학습 데이터에 포함된 편향된 정보가 모델에 영향을 미칠 수 있다
- 평가의 복잡성 : 언어와 시각적 작업이 모두 포함되기 때문에 성능 평가가 어렵다

#### 더 많은 결과
##### 이 밈에 대해 자세히 설명해 주세요
![[Pasted image 20240829001453.png]]

- LLaVA
	- 이 이미지의 밈은 우주의 중심인 치킨 너겟에 초점을 맞춰 음식을 창의적이고 유머러스
하게 표현한 것입니다. 이 밈은 "가끔 우주에서 바라본 지구 사진을 보면 지구가 얼마나
아름다운지 감탄하게 됩니다..."라는 문구로 시작됩니다. 메인 이미지에는 익힌 치킨 너
겟이 담긴 쟁반이 있으며, 치킨 조각은 세계 지도의 대륙과 섬을 닮은 모양으로 배치되어
있습니다. 이 밈은 치킨 너겟이 지구를 상징하며, 사진에 묘사된 다양한 위치는 실제로
각기 다른 장소의 치킨 너겟 버전이라고 장난스럽게 암시합니다. 밈의 핵심은 하단에 작
은 글씨로 "진짜 지구는 아니지만, 이 모든 것이 얼마나 아름다운지"라고 적혀 있습니
다. 이 경쾌하고 재미있는 밈은 치킨 너겟의 이미지를 사용하여 음식과 유머를 결합하
여 세상을 재미있고 상상력 있게 표현합니다.

- GPT-4
	- 이 밈은 우주에서 본 지구 사진과 치킨 너겟이라는 전혀 관련이 없는 두 가지를 결합한
농담입니다. 밈의 텍스트는 아래 이미지가 우주에서 바라본 지구의 아름다운 사진임을
암시합니다. 그러나 실제로는 치킨 너겟을 세계 지도와 비슷하게 배열한 이미지입니다.
이 밈의 유머는 텍스트와 이미지의 예상치 못한 병치에서 비롯됩니다. 텍스트는 장엄한
지구의 이미지를 기대하게 하지만, 실제로는 평범하고 우스꽝스러운 이미지입니다.

- BLIP-2
	- 때때로 우주에서 바라본 지구 사진을 보며 지구가 얼마나 아름다운지 감탄할 때가 있습니다.

- OpenFlamingo
	- 국제우주정거장에 있는 치킨 너겟 사진입니다.

##### HTML 생성
![[Pasted image 20240829003757.png]]

##### 이외에
![[Pasted image 20240829005910.png]]
- 이 재료로 요리할 수 있는 음식은 어떤게 있나요?

![[Pasted image 20240829005937.png]]
- 이곳을 방문할 때 주의할 사항은 무엇인가요? 

![[Pasted image 20240829010754.png]]
 LLaVA라는 모델은 흥미로운 능력을 가지고 있습니다. 예를 들어, 엘론 머스크의 얼굴 사진뿐만 아니라, 엘론 머스크가 도지코인 캐릭터로 변장한 재미있는 밈에서도 그를 인식할 수 있습니다. 이는 LLaVA의 기본적인 CLIP 비전 인코더가 엘론 머스크의 이미지를 본 적이 있을 가능성을 시사합니다.

 하지만 놀라운 점은, 엘론 머스크가 LLaVA의 시각적 특징 정렬이나 시각적 지시 조정 단계의 훈련 데이터에 전혀 포함되지 않았다는 것입니다. 이는 LLaVA의 기본 언어 모델이 보지 못한 시각적 개념을 일반화할 수 있다는 것을 의미합니다.

이는 모델이 특정 인물이나 사물을 직접적으로 학습하지 않았더라도, 그와 관련된 시각적 특징들을 일반화하여 새로운 상황에서도 적용할 수 있다는 뜻입니다

### 교육 세부 정보
1. **사전 훈련 (Pre-training)**:
    - 데이터셋: 필터링된 CC-595K 서브셋
    - 훈련 횟수: 1 에포크 (전체 데이터를 한 번 사용)
    - 학습률: 0.002 (2e-3) (상당히 큰 학습률)
    - 배치 크기: 128 (한 번에 처리하는 데이터 샘플 수)
    - 시간: 4시간
    - 사용한 하드웨어: 8개의 A100 GPU
	
2. **미세 조정 (Fine-tuning)**:
    - 데이터셋: 제안된 LLaVA-Instruct-158K
    - 훈련 횟수: 3 에포크
    - 학습률: 0.00002 (2e-5)
    - 배치 크기: 32
    - 시간: 10시간
    - 사용한 하드웨어: 8개의 A100 GPU

추가적으로:
- **최적화 알고리즘**: Adam 옵티마이저 사용, 가중치 감쇠 없음
- **학습률 조정**: 코사인 학습률 스케줄링 사용, 초기 3%는 워밍업 비율
- **메모리 절약**: FSDP (Full Shard Data Parallel)와 그래디언트 체크포인팅 사용
- **오프로드**: 사용하지 않음
- **정밀도와 속도 균형**: BF16과 TF32 사용
- ScienceQA 데이터셋을 사용한 미세 조정: 4시간 소요

이렇게 모델을 훈련하여 최적의 성능을 얻기 위해 다양한 기술과 설정을 사용했습니다.

### 데이터
######  CC3M 데이터셋의 필터링 과정
- **명사구 추출 및 빈도 계산**:
    - CC3M이라는 큰 데이터셋에서 각 문장에서 명사구(예: "빨간 차", "큰 나무")를 추출합니다.
    - 각 명사구가 몇 번 나오는지 세어봅니다.
    - 3번 미만으로 나오는 명사구는 건너뜁니다. 왜냐하면 너무 드물기 때문입니다.

- **후보 풀 구성**:
    - 남아있는 명사구 중에서 가장 적게 나오는 것부터 시작합니다.
    - 그 명사구가 포함된 문장들을 모아서 후보 목록에 추가합니다.
    - 만약 어떤 명사구가 100번 이상 나오면, 그 중에서 무작위로 100개만 선택합니다.

- **결과**:
    - 이렇게 해서 약 595,000개의 이미지와 텍스트 쌍을 만듭니다.
    - 필터링 전후의 명사구 통계 비교는 그림 7에 나와 있습니다.
    - 필터링된 데이터셋은 3번 이상 나오는 중요한 개념들을 잘 포함하지만, 총 이미지-텍스트 쌍의 수는 줄어듭니다.

![[Pasted image 20240829164526.png]]
- 필터링된 데이터 세트는 빈도가 3보다 높은 개념을 잘 커버하지만 이미지-텍스트 쌍의 수는 더 적습니다

### 1. Captions

이미지에 대한 간단한 설명들입니다. 예를 들어:

- "영화관이 문 위에 상영 시간을 표시하고 있다."
- "빨간 소화전이 깊은 눈 속에 있다."
- "소화전이 최근에 제설된 인도 근처에 있다."
- "이 도시는 매우 혹독한 겨울을 겪고 있다."
- "겨울에 눈 속에 있는 개 호텔."

### 2. Conversation

이미지와 관련된 대화 형식의 질문과 답변입니다. 예시를 통해 설명하겠습니다.

### 프롬프트
###### 예시: 빨간 소화전이 눈 속에 있는 이미지

이미지에 대한 캡션 중 하나는 "빨간 소화전이 깊은 눈 속에 있다."입니다. 이를 바탕으로 한 대화 형식의 질문과 답변은 다음과 같습니다.

- **질문**: "이미지 속 소화전의 색깔은 무엇인가요?" **답변**: "이미지 속 소화전은 빨간색입니다."
    
- **질문**: "소화전이 완전히 눈에 덮여 있나요, 아니면 부분적으로 보이나요?" **답변**: "소화전은 부분적으로 보이며, 상당 부분이 깊은 눈에 덮여 있습니다."
    
- **질문**: "소화전 근처의 인도의 상태는 어떤가요?" **답변**: "소화전 근처의 인도는 최근에 제설되어 주변 지역에 비해 눈이 상대적으로 적습니다."
    
- **질문**: "이 이미지는 도시의 겨울철 상황에 대해 무엇을 시사하나요?" **답변**: "이 이미지는 도시의 겨울철이 매우 혹독하고 도전적이었다는 것을 시사합니다. 이미지에서 보이는 많은 눈은 도시가 많은 강설을 경험했음을 나타내며, 이는 주민들에게 다양한 어려움과 혼란을 초래할 수 있습니다. 예를 들어, 깊은 눈이 소화전을 덮고 있어 긴급 상황에서 접근이 어려울 수 있으며, 이는 안전 문제를 야기할 수 있습니다. 최근에 제설된 인도는 도시의 유지 보수 팀이 보행자들의 안전을 위해 인도를 치우는 작업을 적극적으로 수행하고 있음을 보여주지만, 많은 눈으로 인해 지속적인 제설 작업이 어려울 수 있습니다. 또한, 이러한 극심한 겨울 조건은 교통에 영향을 미쳐 교통 문제, 대중교통 지연, 도로 미끄러짐으로 인한 사고 위험 증가 등을 초래할 수 있습니다. 이는 또한 비즈니스와 학교에도 문제를 일으켜 사람들이 출근하거나 수업에 참석하는 데 어려움을 겪을 수 있습니다. 추가로, 많은 눈은 지붕과 전선 같은 인프라에 추가적인 부담을 주어 구조적 손상이나 정전의 가능성을 높일 수 있습니다. 결론적으로, 깊은 눈 속의 빨간 소화전과 최근에 제설된 인도 이미지는 도시가 특히 심한 겨울철을 겪고 있으며, 많은 강설로 인해 주민들과 인프라에 다양한 도전과 혼란을 초래했음을 시사합니다."
    

### 요약

이 내용은 이미지에 대한 설명과 대화를 통해 이미지를 더 잘 이해할 수 있도록 돕는 예시입니다. 간단한 캡션을 통해 이미지를 설명하고, 그 이미지를 바탕으로 한 질문과 답변을 통해 이미지를 더 깊이 이해할 수 있습니다. 이러한 다양한 설명 방식은 인공지능 모델이 이미지를 더 잘 이해하고 설명할 수 있도록 훈련하는 데 사용됩니다.