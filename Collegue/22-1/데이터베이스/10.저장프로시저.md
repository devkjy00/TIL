# 저장 프로시저의 개요와 정의
> 학습내용
- 저장 프로시저의 개요, 정의, 사용

## 저장 프로시저의 개요
- 개요
    - T-SQL 문장들의 모음, 함수의 역할
    - 입/출력 매개변수를 지원해서 절차적으로 비즈니스 로직을 구현할 수 있게 해준다

- 장점
    - 다수 개의 T-SQL 문장을 조합, 모듈화 할 수 있다
    - 변수를 통해 동적으로 데이터를 처리, 다양한 연산 결과 출력가능
    - 프로시저는 컴파일된 후 실행계획이 저장되서 재사용할 때 성능이 향상 된다
    - 특정 사용자에게 특정 저장 프로시저만 허용해서 보안기능을 정의할 수 있다

- 저장 프로시저의 정의
    ```sql
    CREATE { PROC | PROCEDURE } procedure_name
    [ { @parameter data_type } [ =default ] 
    [OUT | OUTPUT] ][, ...n ] 
    [ WITH <procedure_option> [, ...n] ]
    [ FOR REPLICATION ]
    AS
    [BEGIN]
    <sql_statement> [;] [ ...n ]
    [END]
    ```
    - procedure_name : 저장 프로시저 이름
        - 개체 이름 중 유일해야 한다
        - 최대 128자를 초과 할 수 없다
    - @parameter : 저장 프로시저의 매개변수 이름, 하나의 프로시저에서 최대 2,100개의 매개변수 지정 가능
    - data_type: 매개변수가 속하는 데이터의 데이터 형
    - default : 필요에 따라 지정하는 매개변수의 기본값
    - OUT|OUTPUT : 출력 매개변수임(반환값)을 명시
    - WITH : 저장 프로시저의 부가적인 선택사항을 지정
    - FOR REPLICATION : 복제용으로 만들어진 저장 프로시저 

- 저장 프로시저 사용
    ```sql
    EXEC procedure_name [ 'value' | @var ] ...n
    ```
    - 출력 매개변수를 가지는 저장 프로시저
        ```sql
        DECLARE @var int
        EXEC procedure_name @return = @var OUTPUT
        SELECT * FROM table
        WHERE x = @var;
        ```
        - 출력 매개변수 할당문의 위치가 반대, 등호 오른쪽 변수에 반환값을 저장한다