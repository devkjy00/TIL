# 8-3 상관관계와 공분산/ 유일 값, 값 세기, 멤버심

- ## 상관관계(Correlation)
    - 결과 값이 1가까울 수록 A값과 B값이 비례한다
    - 결과 값이 -1에 가까울 수록 A값과 B값이 반 비례한다
    
- ## 공분산(Coavariance)
    - 확률변수가 절대적인 크기에 영향을 받지않도록 일정하게 만드는 것

```py
import pandas_datareader.data as web
# 주가정보를 다운로드 받을 수 있게해주는 라이브러리
all_data = {ticker: web.get_data_yahoo(ticker)
        for ticker in ['AAPL', 'IBM', 'MSFT', 'GOOG', 'TSLA', 'AMZN']}
price = pd.DataFrame({ticker: data['Adj Close'] 
    # Adj Close : 수정 종가
        for ticker, data in all_data.items()})

volume = pd.DataFrame({ticker: data['Volume']
        for ticker, data in all_data.items()}) 
    # 'Volume : all_data에 저장된 종목들의 거래량

returns = price.pct_change()# 퍼센트_체인지
# price에 저장되어있는 주가의 퍼센트 변화율을 반환한다
returns.tail()
# 마지막 5일간의 정보를 반환한다

returns['MSFT'].corr(returns['IBM'])
# .corr() 두객체의 상관관계를 계산하는 메서드
# 상관관계가 1에 가까울 수록 두 주가가 같이 올라가고 같이내려가고, -1에 가까울수록 반비례해서 움직인다는 뜻

returns['MSFT'].cov(returns['IBM'])
# .cov() 두객체의 공분산을 구하는 메서드

returns.corr()
returns.cov()
# 저장된 정보들 의 상관관계, 공분산을 반환

returns.corrwith(returns.IBM)
# .corrwith(): Series,DataFrame과의 상관관계를 계산

returns.corrwith(volume)
# 거래량의 퍼센트 변화율에 대한 상관관계를 계산한다

```
- ### 유일 값, 값 세기, 멤버십
```py
obj = pd.Sries(['c','a','d','a','a','b'])

uniques = obj.unique()
# .unique() : 유일 값을 정렬하지 않고 반환

obj.value_counts()
# .value_counts() : Series에서 중복된 값이 몇개인지 계산

pd.value_counts(obj.values, sort=False)
# 정렬되지 않은 순서로 반환

mask = obj.isin(['b','c'])
# .isin() : 어떤 값이 Series에 존재하는지 각 인덱스를 불리언 벡터로 반환한다.
obj[mask]
# True 값인 인덱스만 반환

```

# 9. 데이터 로딩과 저장, 파일형식
- pandas의 파일 파싱 함수
    - read_csv : 파일, URL 또는 파일과 유사한 객체로부터 구분된 데이터를 읽어 온다. 데이터 구분자는 쉼표(,)를 기본으로 한다.
    - read_table : 파일, URL 또는 파일과 유사한 객체로부터 구분된 데이터를 읽어 온다. 데이터 구분자는 탭('\t')을 기본으로 한다.
    - read_excel : 엑셀 파일에서 표 형식의 데이터를 읽어 온다.
    - read_html : HTML 문서 내의 모든 테이블의 데이터를 읽어 온다.
    - read_clipboard : 클립보드에 있는 데이터를 읽어 온다.
    - read_hdf : pandas에서 저장한 HDF5(binary파일)데이터를 읽어온다
    - JSON 문자열에서 데이터를 읽어온다
    - read_sql : SQL 쿼리 결과를 pandas의 DataFrame 형식으로 읽어온다. 

- pandas파일 파싱함수의 주요 옵션
    - 색인 
        - 반환하는 DataFrame에서 하나이상의 컬럼을 색인으로 지정할 수 있다
        - 파일이나 사용자로부터 컬럼 이름을 받거나 아무것도 받지 않을 수 있다
    - 자료형 추론과 데이터 변환
        - 사용저 정의 값 변환과 비어있는 값을 위한 사용자 리스트를 포함한다.
    - 날짜 분석
        - 여러 컬럼에 걸쳐 있는 날짜와 시간 정보를 하나의 컬럼에 조합해서 결과레 반영한다.
    - 반복 
        - 여러개의 파일에 걸쳐 있는 자료를 반복적으로 읽어 올 수 있다.
    - 정제되지 않은 데이터 처리
        - 로우나 꼬리말, 주석 건너뛰기 또는 천 단위마다 쉼표로 구분된 숫자 같은 것들의 처리

-  *타입추론*
    - pandas.read_csv 같은 함수들은 데이터 형식에 자료형이 포함되어 있지 않은 관계로 타입 추론을 수행한다.

- ###  *텍스트 파일에서 데이터 읽고 쓰기*

    - 먼저 OS의 type명령을 써서 csv파일의 내용을 살펴본다
    ```py
    !type examples\ex1.csv
    # 윈도우
    !cat examples/ex1.csv
    # 리눅스, 유닉스
    ```
    - 쉼표로 구분된 텍스트 데이터 파일은 read_csv 함수를 사용해서 DataFrame으로 읽어올 수 있다.
    ```py
    df = pd.read_csv("/ex1.csv")
    ```
    - 쉼표로 구분된 텍스트 데이터파일은 read_table 함수에 구분자(sep옵션)을 지정해서 DataFrame으로 읽어 올 수 있다.
    ```py
    pd.read_table('ex1.csv', sep=',')
    ```
    - 텍스트 파일에서 DataFrame으로 데이터 읽어 올 때 색인 지정하기
    ```py
    pd.read_csv('ex1.csv', header=None)
    # 로우,컬럼 값이 0,1,2,... 로 생성
    pd.read_csv('ex1.csv', names=['a','b','c','d'], index_col = 'd')
    # names으로 컬럼색인을 생성하고 index_col으로 입력한 컬럼의 값을 인덱스 색인으로 사용할 수 있다.
    ```
- 계층적 색인
    ```py
    pd.read_csv('ex.csv', index_col=['a','b'])
    # 인덱스색인 값을 2개의 계층으로 나눠서 사용 할 수 있다
    # 'a'컬럼 값이 같은 것끼리 묶어서 'b'컬럼값을 정렬한 2계층 인덱스색인이 생성된다
    # 예제
    #       c d f
    # a b 
    # 1 x / 1,2,3
    #   y / 2,4,6
    # 2 z / 1,5,7
    #   q / 2,5,8
    ```
- 구분자없이 공백,다른패턴으로 필드를 구분한 경우
    ```py
    pd.read_table('ex1.txt', sep='\s+')
    # 공백,다른패턴일 경우 '\s+'가 자동적으로 데이터를 구분 시킨다
    ```
- 그 외의 read_csv,reac_table의 함수인자
    - skiprows : 파일의 시작부터 무시할 행의 수 또는 무시할 로우번호가 담긴 리스트
    - na_values : NA값으로 처리할 값들의 목록(컬럼값은 리스트, 컬럼의 특정값은 사전으로 지정한다)
    - comment : 주석으로 분류되어 파싱하지 않을 문자 혹은 문자열
    - thousand : 숫자를 천단위로 끊을 때 사용할 ',' '.' 같은 구분자